//Task 4.2(20)
/*
Проанализировать текст в заданном файле. Вычислить среднее
число букв в слове и слов в предложении. Вывести самое длинное
слово и предложение на экран.
*/

#pragma warning (disable : 4996) 
#include <stdio.h>
#include <string.h>
#include <ctype.h>
#define len 100

int main()
{
	FILE* file;
	char str[len];
	//char *str = (char*)malloc(len);
	int i, LetterCount = 0, SpaceCount = 0, DotCount = 0;
	int WordLen = 0, MaxWordLen = 0, WordIndex = 0;
	int SentenceLen = 0, MaxSentenceLen = 0, SentenceIndex = 0;
	//int lettercount[3] = { 0, 0, 0 }, wordcount[3] = { 0, 0, 0 };//[длина текущего слова][длина самого большого слова][индекс первой буквы слова]
	file = fopen("TEXT.txt", "r");
	if (file != 0)
	{
		printf("File is open");
		for (i = 0; !feof(file); i++)
		{
			fscanf(file, "%c", &str[i]);
		}
		str[i-1] = '\0';
		for (i = 0; str[i] != '\0'; i++)
		{
			if (str[i] == ' ')
			{
				SpaceCount++;
			}
			if (str[i] == '.')
			{
				DotCount++;
				if (SentenceLen > MaxSentenceLen)
				{
					MaxSentenceLen = SentenceLen;
					SentenceIndex = i - SentenceIndex;
				}
				SentenceLen = 0;
			}
			if (str[i] == ' ' || str[i] == '.')
			{
				if (WordLen > MaxWordLen)
				{
					MaxWordLen = WordLen;
					WordIndex = i - MaxWordLen;
				}
				WordLen = 0;
			}
			if (isalpha(str[i]))
			{
				WordLen++;
				LetterCount++;
			}
			SentenceLen++;
		}
		str[SentenceIndex + MaxSentenceLen] = '\0';
		printf("\n\n%s", str);
		printf("\n\nLongest sentence : %s", &str[SentenceIndex]);
		str[WordIndex + MaxWordLen] = '\0';
		printf("\nLongest word : %s", &str[WordIndex]);
		printf("\nAverage letter count : %d\nAverage word count : %d\n", LetterCount / (SpaceCount + 1), (SpaceCount + 1) / DotCount);
	}
	else
	{
		printf("File can't be open");
		return 0;
	}
	fclose(file);
}
